(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b344c"],{"283c":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[t._m(0),n("div",{staticClass:"navbar-container box-shadow"},[n("div",{staticClass:"container-fluid "},[n("hr",{staticClass:"normal"}),n("div",{staticClass:"navbar-header clearfix"},[n("ul",{staticClass:"flex pull-right"},[t.clickBound?n("li",[n("el-button",{staticClass:"cds-button",attrs:{type:"text"},on:{click:function(e){return t.FnGetRulesList("remove")}}},[t._v("移除规则")])],1):n("li",[n("el-button",{staticClass:"cds-button",attrs:{type:"text"},on:{click:t.FnOperateRules}},[t._v("绑定规则")])],1)])])])]),n("div",{staticClass:"content"},[n("el-table",{staticClass:"table--transparent",attrs:{data:t.list}},[n("el-table-column",{attrs:{label:"规则名称",prop:"name"}}),n("el-table-column",{attrs:{label:"状态",prop:"status_str"}}),n("el-table-column",{attrs:{label:"启用"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.is_active?n("span",[t._v("已启用")]):n("span",[t._v("已禁用")])]}}])}),n("el-table-column",{attrs:{label:"监控项",prop:"metrics_id_str"}}),n("el-table-column",{attrs:{label:"报警规则"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.period_str)+" "+t._s(e.row.lasted_period_str)+" "+t._s(e.row.metrics_id_str)+" "+t._s(e.row.trigger_type_str)+" "+t._s(e.row.trigger_symbol)+t._s(e.row.value)+t._s(e.row.unit)+' 则发"'+t._s(e.row.level_str)+'"报警 ')]}}])}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("ul",{staticClass:"flex flex-center"},[t.clickBound?n("li",[n("span",{staticClass:"light pointer",on:{click:function(n){return t.FnBoundRules(e.row)}}},[t._v("绑定")])]):t._e(),t.clickBound?t._e():n("li",[n("span",{staticClass:"light pointer",on:{click:function(n){return t.FnRemoveInstance(e.row)}}},[t._v("移除")])])])]}}])})],1),n("el-pagination",{staticClass:"pull-right",attrs:{background:!0,"current-page":t.currentPage,"page-size":t.page_size,"prev-text":"上一页","next-text":"下一页",layout:"prev, pager, next, jumper",total:t.list_num},on:{"current-change":t.handleCurrentChange}})],1)])},r=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"navbar-container"},[n("div",{staticClass:"container-fluid"},[n("div",{staticClass:"navbar-header"},[n("span",{staticClass:"page-title"},[t._v("报警规则")])])])])}],a=(n("4160"),n("b0c0"),n("b64b"),n("159b"),n("9e1f"),n("450d"),n("6ed5")),i=n.n(a),c=(n("0fb7"),n("f529")),u=n.n(c),o=(n("96cf"),n("89ba")),l=n("5724");function p(t){return Object(l["a"])({method:"post",url:"/alarm/rule/delete_instance",data:t})}function d(t){return Object(l["a"])({method:"post",url:"/alarm/rule/add_instance",data:t})}function m(t){return Object(l["a"])({method:"post",url:"/alarm/rule/instance_link_rule",data:t})}function f(t){return Object(l["a"])({method:"post",url:"/alarm/rule/instance_nolink_rule",data:t})}var h={components:{},data:function(){return{list:[],currentPage:1,page_size:20,list_num:0,clickBound:!1}},created:function(){this.FnGetRulesList("first")},methods:{handleCurrentChange:function(t){this.currentPage=t,this.FnGetRulesList()},FnGetRulesList:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){var n,s,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.list=[],n={instance_id:this.$route.params.id,page_number:this.currentPage,page_size:this.page_size,type:this.$route.params.type},"remove"===e&&(this.clickBound=!1),!this.clickBound){t.next=9;break}return t.next=6,f(n);case 6:t.t0=t.sent,t.next=12;break;case 9:return t.next=11,m(n);case 11:t.t0=t.sent;case 12:s=t.t0,"Success"===s.code?(this.list_num=s.total_count,this.list=s.data,"first"===e&&this.list.length<=0&&(this.clickBound=!0,this.FnGetRulesList()),r=[],a=[],this.list.forEach((function(t){a=Object.keys(t.notification_group),a.forEach((function(e){r.push({id:e,name:t.notification_group[e]})})),t.group_list=r}))):u()({message:s.msg,type:"error"});case 14:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),FnOperateRules:function(){this.clickBound=!0,this.FnGetRulesList()},FnRemoveInstance:function(t){var e=this;i.a.confirm("确认将该实例移除此报警规则吗？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then((function(){e.confrimRemove(t)}))},confrimRemove:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){var n,s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=[],n.push(e.id),s={rule_ids:n,instance_id:this.$route.params.id},t.next=5,p(s);case 5:r=t.sent,"Success"===r.code?(this.FnGetRulesList(),u()({message:r.msg,type:"success"})):u()({message:r.msg,type:"error"});case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),FnBoundRules:function(t){var e=this;i.a.confirm("确认该实例应用此报警规则吗？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then((function(){e.confirmBoundRules(t)}))},confirmBoundRules:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){var n,s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=[],n.push(e.id),s={rule_ids:n,instance_id:this.$route.params.id,product_type:this.$route.params.type,instance_name:this.$route.params.name},t.next=5,d(s);case 5:r=t.sent,"Success"===r.code?(this.FnGetRulesList(),u()({message:r.msg,type:"success"})):u()({message:r.msg,type:"error"});case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}},_=h,g=n("2877"),b=Object(g["a"])(_,s,r,!1,null,null,null);e["default"]=b.exports}}]);
//# sourceMappingURL=chunk-2d0b344c.c0cb2f52.js.map