(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ba97c3f"],{"0d03":function(t,e,a){var s=a("6eeb"),n=Date.prototype,r="Invalid Date",i="toString",o=n[i],l=n.getTime;new Date(NaN)+""!=r&&s(n,i,(function(){var t=l.call(this);return t===t?o.call(this):r}))},5319:function(t,e,a){"use strict";var s=a("d784"),n=a("825a"),r=a("7b0b"),i=a("50c4"),o=a("a691"),l=a("1d80"),u=a("8aa5"),c=a("14c3"),d=Math.max,p=Math.min,_=Math.floor,m=/\$([$&'`]|\d\d?|<[^>]*>)/g,f=/\$([$&'`]|\d\d?)/g,h=function(t){return void 0===t?t:String(t)};s("replace",2,(function(t,e,a){return[function(a,s){var n=l(this),r=void 0==a?void 0:a[t];return void 0!==r?r.call(a,n,s):e.call(String(n),a,s)},function(t,r){var l=a(e,t,this,r);if(l.done)return l.value;var _=n(t),m=String(this),f="function"===typeof r;f||(r=String(r));var v=_.global;if(v){var b=_.unicode;_.lastIndex=0}var g=[];while(1){var y=c(_,m);if(null===y)break;if(g.push(y),!v)break;var k=String(y[0]);""===k&&(_.lastIndex=u(m,i(_.lastIndex),b))}for(var x="",C=0,S=0;S<g.length;S++){y=g[S];for(var D=String(y[0]),w=d(p(o(y.index),m.length),0),O=[],$=1;$<y.length;$++)O.push(h(y[$]));var I=y.groups;if(f){var A=[D].concat(O,w,m);void 0!==I&&A.push(I);var B=String(r.apply(void 0,A))}else B=s(D,m,w,O,I,r);w>=C&&(x+=m.slice(C,w)+B,C=w+D.length)}return x+m.slice(C)}];function s(t,a,s,n,i,o){var l=s+t.length,u=n.length,c=f;return void 0!==i&&(i=r(i),c=m),e.call(o,c,(function(e,r){var o;switch(r.charAt(0)){case"$":return"$";case"&":return t;case"`":return a.slice(0,s);case"'":return a.slice(l);case"<":o=i[r.slice(1,-1)];break;default:var c=+r;if(0===c)return e;if(c>u){var d=_(c/10);return 0===d?e:d<=u?void 0===n[d-1]?r.charAt(1):n[d-1]+r.charAt(1):e}o=n[c-1]}return void 0===o?"":o}))}}))},ae90:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"c",(function(){return r})),a.d(e,"d",(function(){return i})),a.d(e,"b",(function(){return o}));var s=a("5724");function n(){return Object(s["a"])({method:"get",url:"/api/vm/app/list/",loadingStatus:!0})}function r(t){return Object(s["a"])({method:"get",url:"/bms/v1/list",params:t,loadingStatus:!0})}function i(t){return Object(s["a"])({method:"post",url:"/bms/v1/monitor",data:t})}function o(t){return Object(s["a"])({method:"get",url:"/bms/v1/detail/"+t})}},baa5:function(t,e,a){var s=a("23e7"),n=a("e58c");s({target:"Array",proto:!0,forced:n!==[].lastIndexOf},{lastIndexOf:n})},d81d:function(t,e,a){"use strict";var s=a("23e7"),n=a("b727").map,r=a("1dde");s({target:"Array",proto:!0,forced:!r("map")},{map:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},e58c:function(t,e,a){"use strict";var s=a("fc6a"),n=a("a691"),r=a("50c4"),i=a("b301"),o=Math.min,l=[].lastIndexOf,u=!!l&&1/[1].lastIndexOf(1,-0)<0,c=i("lastIndexOf");t.exports=u||c?function(t){if(u)return l.apply(this,arguments)||0;var e=s(this),a=r(e.length),i=a-1;for(arguments.length>1&&(i=o(i,n(arguments[1]))),i<0&&(i=a+i);i>=0;i--)if(i in e&&e[i]===t)return i||0;return-1}:l},f093:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[t._m(0),a("div",{staticClass:"navbar-container"},[a("div",{staticClass:"container-fluid"},[a("hr",{staticClass:"normal"}),a("div",{staticClass:"navbar-header flex clearfix"},[a("el-select",{attrs:{placeholder:"请选择VDC","value-key":"id"},model:{value:t.currentApp,callback:function(e){t.currentApp=e},expression:"currentApp"}},t._l(t.app_list,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t}})})),1),a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入IP地址"},model:{value:t.ip_string,callback:function(e){t.ip_string=e},expression:"ip_string"}},[a("el-button",{attrs:{slot:"append"},on:{click:t.FnGetBmsList},slot:"append"},[a("i",{staticClass:"el-icon-search"})])],1)],1)])]),a("div",{staticClass:"navbar-container box-shadow"},[a("div",{staticClass:"container-fluid",staticStyle:{"padding-bottom":"10px"}},[a("p",[t._v("下面列表只显示开通监控权限的裸金属：")]),a("div",{staticClass:"border",staticStyle:{padding:"10px 20px"}},[a("el-radio-group",{staticClass:"purple-color",model:{value:t.currentBms,callback:function(e){t.currentBms=e},expression:"currentBms"}},t._l(t.bms_list,(function(e){return a("el-radio",{key:e.id,attrs:{label:e}},[a("span",{domProps:{textContent:t._s(e.name)}})])})),1),t.bms_list.length<=0?a("p",{staticStyle:{"text-align":"center"}},[t._v("暂无数据！")]):t._e()],1),t.currentBms?a("p",{staticClass:"m-top20"},[a("el-button",{staticClass:"cds-button",attrs:{type:"primary"},on:{click:t.FnCheckMonitorData}},[t._v("查看监控数据")])],1):t._e()])]),t.searchStatus?a("div",{staticClass:"m-top20"},[t.currentBms?a("div",{staticClass:"card-form"},[a("p",[a("label",[t._v("编号：")]),a("span",[t._v(t._s(t.currentBms.id))])]),a("p",[a("label",[t._v("所属虚拟数据中心：")]),a("span",[t._v(t._s(t.currentBms.appName))]),a("label",{staticClass:"m-left30"},[t._v("区域：")]),a("span",[t._v(t._s(t.currentBms.regionName))])])]):t._e(),a("div",{staticClass:"card-form"},[a("el-radio-group",{staticClass:"purple-color",model:{value:t.monitor_type_default,callback:function(e){t.monitor_type_default=e},expression:"monitor_type_default"}},t._l(t.monitor_type_list,(function(e,s){return a("el-radio-button",{key:s,attrs:{label:e}},[a("span",{domProps:{textContent:t._s(e.text)}})])})),1)],1),a("div",{staticClass:"card-form"},[a("el-radio-group",{staticClass:"purple-color",model:{value:t.sel_time,callback:function(e){t.sel_time=e},expression:"sel_time"}},t._l(t.time_list,(function(e,s){return a("el-radio-button",{key:s,attrs:{label:e.value}},[a("span",{domProps:{textContent:t._s(e.text)}})])})),1)],1),t.monitor_type_default?a("div",t._l(t.monitor_type_default.tab_list,(function(e,s){return a("div",{key:s,staticClass:"card-form"},[a("div",{staticClass:"card-article"},[a("span",[t._v(t._s(e.title))]),a("el-radio-group",{staticClass:"purple-color m-left30",model:{value:e.default,callback:function(a){t.$set(e,"default",a)},expression:"item.default"}},t._l(e.data_list,(function(s,n){return a("el-radio-button",{key:n,attrs:{label:s,value:s}},["disk"==e.type?a("span",{domProps:{textContent:t._s(s.volumePath)}}):t._e(),"nic"==e.type?a("span",{domProps:{textContent:t._s(s.ipAddress)}}):t._e()])})),1)],1),a("div",{class:{grid:"source"==t.monitor_type_default.type}},t._l(e.list,(function(e,s){return a("div",{key:s,staticClass:"card border background-fff"},[e.loading_stauts?a("div",{staticStyle:{display:"inline-block"}},[a("i",{staticClass:"el-icon-loading"}),t._v(" "),a("span",[t._v("数据正在加载中")])]):t._e(),!e.loading_stauts&&e.nomoreData_stauts?a("span",[t._v("暂无数据！")]):t._e(),e.loading_stauts||e.nomoreData_stauts||"disk_used"==e.value?t._e():a("div",{staticClass:"chart-container",attrs:{id:e.value}}),e.loading_stauts||e.nomoreData_stauts||"disk_used"!=e.value?t._e():a("table",{staticClass:"table"},[t._m(1,!0),a("tbody",t._l(t.diskUsedData,(function(e,s){return a("tr",{key:s},[a("td",{domProps:{textContent:t._s(e.fileSystemSize)}},[t._v("39G")]),a("td",{domProps:{textContent:t._s(e.fileSystemFree)}},[t._v("G")]),a("td",{domProps:{textContent:t._s(e.mountpoint)}},[t._v("/")])])})),0)])])})),0)])})),0):t._e()]):t._e()])},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"navbar-container"},[a("div",{staticClass:"container-fluid navbar-header flex"},[a("span",{staticClass:"page-title"},[t._v("裸金属监控")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",[t._v("容量")]),a("th",[t._v("可用")]),a("th",[t._v("挂载点")])])])}],r=(a("4160"),a("baa5"),a("d81d"),a("0d03"),a("b0c0"),a("b64b"),a("ac1f"),a("5319"),a("159b"),a("0fb7"),a("450d"),a("f529")),i=a.n(r),o=(a("96cf"),a("89ba")),l=a("ae90"),u={data:function(){return{time_list:[{value:"fifteen_minutes",text:"15分钟"},{value:"one_hour",text:"1小时"},{value:"one_day",text:"1天"}],sel_time:"",monitor_type_list:[{type:"source",text:"资源监控",tab_list:[{title:"CPU/内存",type:"cpu/ram",list:[{value:"cpu_used",loading_stauts:!1,nomoreData_stauts:!1},{value:"mem_used",loading_stauts:!1,nomoreData_stauts:!1}]},{title:"磁盘监控指标",type:"disk",list:[{value:"disk_used",loading_stauts:!1,nomoreData_stauts:!1},{value:"disk_iops",loading_stauts:!1,nomoreData_stauts:!1},{value:"disk_throughput",loading_stauts:!1,nomoreData_stauts:!1}],data_list:[],default:null},{title:"网络监控指标",type:"nic",list:[{value:"network_throughput",loading_stauts:!1,nomoreData_stauts:!1}],data_list:[],default:null}]},{type:"device",text:"设备监控",tab_list:[{title:"CPU温度",type:"cpu",list:[{value:"cpu_temperature",loading_stauts:!1,nomoreData_stauts:!1}]},{title:"风扇转速",type:"fan",list:[{value:"fan",loading_stauts:!1,nomoreData_stauts:!1}]}]}],monitor_type_default:null,app_list:[],currentApp:null,ip_string:"",bms_list:[],currentBms:null,loading_stauts:!1,nomore_stauts:!1,disk_list:[],diskDefault:null,nic_list:[],nicDefault:null,searchStatus:!1,diskUsedData:[]}},methods:{FnGetAppList:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["a"])();case 2:e=t.sent,"Success"===e.code?this.app_list=e.data:i()({message:e.msg,type:"error"});case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),FnGetBmsList:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,s,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.bms_list=[],this.currentBms=null,e={appId:this.currentApp.id,ipString:this.ip_string,current:1,size:1e4},t.next=5,Object(l["c"])(e);case 5:a=t.sent,"Success"===a.code?(s=a.data?a.data.records:[],this.bms_list,s.forEach((function(t){t.enableMonitor&&n.bms_list.push(t)}))):i()({message:a.msg,type:"error"});case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),FnCheckMonitorData:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["b"])(this.currentBms.id);case 2:e=t.sent,"Success"===e.code?(this.monitor_type_list[0].tab_list[1].data_list=e.data?e.data.volumes:[],this.monitor_type_list[0].tab_list[1].default=this.monitor_type_list[0].tab_list[1].data_list[0],this.monitor_type_list[0].tab_list[2].data_list=e.data?e.data.networks.networkCards:[],this.monitor_type_list[0].tab_list[2].default=this.monitor_type_list[0].tab_list[2].data_list[0],this.searchStatus=!0,this.monitor_type_default=this.monitor_type_list[0]):i()({message:"获取数据失败！",type:"error"});case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),FnGetMonitorData:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e,a){var s,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s={type:e.value,filter:{bmsId:this.currentBms.id}},"disk_used"!==e.value&&(s.timeGranularity=this.sel_time),"disk_throughput"!==e.value&&"disk_iops"!==e.value&&"network_throughput"!==e.value||(s.device=a.default.id),"device"===this.monitor_type_default.type&&(s.groupbyParams="cpu_temperature"===e.value?"cpuId":"fanId"),this.$set(e,"loading_stauts",!0),t.next=7,Object(l["d"])(s);case 7:n=t.sent,"Success"===n.code?(r=n.data,this.$set(e,"loading_stauts",!1),"disk_used"!==e.value?r.timestamp.length>0?(this.$set(e,"nomoreData_stauts",!1),this.setOptionData(r,e.value)):this.$set(e,"nomoreData_stauts",!0):r.length>0?(this.diskUsedData=r,this.$set(e,"nomoreData_stauts",!1)):this.$set(e,"nomoreData_stauts",!0)):(this.$set(e,"loading_stauts",!1),this.$set(e,"nomoreData_stauts",!0),i()({message:"获取数据失败！",type:"error"}));case 9:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),setOptionData:function(t,e){var a=this;t&&this.$nextTick((function(){var s=a.$echarts.init(document.getElementById("".concat(e))),n=a.FnFormatData(t,e),r=n.unit,i=n.date,o=n.seriesData,l=n.schemeData,u=a,c={tooltip:{trigger:"axis",backgroundColor:"rgba(0,0,0,0.8)",borderColor:"#f50",borderWidth:2,padding:10,formatter:function(t){for(var e=t[0].name,a=0,s=t.length;a<s;a++)e+="<br/>"+t[a].seriesName+" : "+t[a].value;return e}},legend:{orient:"vertical",x:"right",y:"center",data:l},grid:{top:"7%",left:"6%",right:"14%",bottom:"6%",containLabel:!0,show:!0},toolbox:{left:"center",feature:{dataZoom:{show:!0,title:{zoom:"区域缩放",back:"区域缩放-后退"},yAxisIndex:"none",iconStyle:{normal:{borderColor:"#333"},emphasis:{borderColor:"#4984E7"}}},restore:{title:"还原",iconStyle:{normal:{borderColor:"#333"},emphasis:{borderColor:"#4984E7"}}},saveAsImage:{name:"公网流量图",title:"保存为图片",iconStyle:{normal:{borderColor:"#333"},emphasis:{borderColor:"#4984E7"}}}}},dataZoom:[{handleSize:8},{type:"inside"}],calculable:!0,xAxis:[{type:"category",boundaryGap:!1,data:i.map((function(t){return t.replace(" ","\n")})),axisLabel:{formatter:function(t){var e=new Date(t.replace("-","/").replace("-","/")),a=u.getStrNum(e.getHours()),s=u.getStrNum(e.getMinutes()),n=u.getStrNum(e.getMonth()+1),r=u.getStrNum(e.getDate());return a+":"+s+"\n"+n+"/"+r}}}],yAxis:[{name:"("+r+")",type:"value",splitNumber:10,axisLabel:{show:!0},splitLine:{lineStyle:{type:"dashed"}}}],series:[]};c.series=o,s.setOption(c)}))},FnFormatData:function(t,e){var a=[],s=Object.keys(t),n=[],r=[],i="Mbps",o={name:"",type:"line",label:{normal:{show:!1,position:"top"}},smooth:!0,smoothMonotone:"x",data:[]};if("source"===this.monitor_type_default.type)s.forEach((function(s){if("timestamp"===s)a=t[s];else if("bms_disk_bytes_read_info"===s||"bms_network_receive_bytes_info"===s)o.name="bms_disk_bytes_read_info"===s?"读":"入网流量",o.data=t[s],n.push(JSON.parse(JSON.stringify(o))),r.push({name:o.name});else{switch(e){case"cpu_used":o.name="cpu使用率",i="%";break;case"disk_used":o.name="磁盘使用率",i="%";break;case"mem_used":o.name="内存使用率",i="%";break;case"disk_iops":o.name="IOPS",i="IOps";break;case"disk_throughput":o.name="写";break;case"network_throughput":o.name="出网流量";break;default:break}o.data=t[s],n.push(JSON.parse(JSON.stringify(o))),r.push({name:o.name})}}));else{var l="";i="cpu_temperature"===e?"摄氏度":"RPM",s.forEach((function(s,i){if("timestamp"===s)a=t[s];else{if("cpu_temperature"===e)l="cpu"+s.replace(/[^\d]/g,"");else{var u=s.lastIndexOf("_");l="风扇"+s.substr(u,s.length-1)}o.name=l,o.data=t[s],n.push(JSON.parse(JSON.stringify(o))),r.push({name:o.name})}}))}return{unit:i,date:a,seriesData:n,schemeData:r}},getStrNum:function(t){return t<10?"0"+t:t}},mounted:function(){this.FnGetAppList();var t=this;window.onresize=function(){t.monitor_type_default&&t.monitor_type_default.tab_list.forEach((function(e){e.list.forEach((function(e){if("disk_used"!==e.value){var a=t.$echarts.init(document.getElementById("".concat(e.value)));a.resize()}}))}))}},watch:{monitor_type_default:function(t,e){var a=this;t!==e&&t&&(this.sel_time!==this.time_list[0].value?this.sel_time=this.time_list[0].value:this.monitor_type_default.tab_list.forEach((function(t){t.list.forEach((function(e){a.$set(e,"loading_stauts",!0),a.FnGetMonitorData(e,t)}))})))},sel_time:function(t,e){var a=this;t!==e&&this.monitor_type_default.tab_list.forEach((function(t){t.list.forEach((function(e){a.$set(e,"loading_stauts",!0),a.FnGetMonitorData(e,t)}))}))},currentBms:function(t,e){t!==e&&(this.searchStatus=!1,console.log(111,this.searchStatus))}}},c=u,d=a("2877"),p=Object(d["a"])(c,s,n,!1,null,null,null);e["default"]=p.exports}}]);
//# sourceMappingURL=chunk-2ba97c3f.26d9127e.js.map