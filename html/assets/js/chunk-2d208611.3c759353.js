(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d208611"],{a518:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[a("div",{staticClass:"navbar-container"},[a("div",{staticClass:"container-fluid"},[t._m(0),a("div",{staticClass:"navbar-tool pull-right flex"},[a("el-button",{staticClass:"cds-button",attrs:{type:"primary"},on:{click:function(e){return t.add_contact_person("add")}}},[t._v("新建联系人")])],1)])]),a("div",{staticClass:"navbar-container box-shadow"},[a("div",{staticClass:"container-fluid"},[a("hr",{staticClass:"normal"}),a("div",{staticClass:"navbar-header flex"},[a("el-select",{attrs:{placeholder:"全部"},model:{value:t.condition,callback:function(e){t.condition=e},expression:"condition"}},t._l(t.condition_list,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),a("el-input",{staticClass:"m-left30",staticStyle:{width:"300px"},attrs:{clearable:"",placeholder:t.placeholder_text},on:{clear:function(e){return t.get_contact_person_list("1")}},model:{value:t.search_value,callback:function(e){t.search_value=e},expression:"search_value"}},[a("el-button",{attrs:{slot:"append",type:"primary"},on:{click:function(e){return t.get_contact_person_list("1")}},slot:"append"},[a("i",{staticClass:"el-icon-search"})])],1)],1)])]),a("div",{staticClass:"content"},[a("el-table",{staticClass:"table--transparent",attrs:{data:t.contact_person_list,"show-overflow-tooltip":"","tooltip-effect":"light"}},[a("el-table-column",{attrs:{label:"姓名",prop:"contact_name"}}),a("el-table-column",{attrs:{label:"邮箱",prop:"contact_email"}}),a("el-table-column",{attrs:{label:"所属报警组",prop:"contact_group"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.contact_group,(function(o){return a("span",[e.row.contact_group.indexOf(o)<e.row.contact_group.length-1?a("span",[t._v(t._s(o+","))]):a("span",[t._v(t._s(o))])])}))}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("ul",{staticClass:"flex flex-center"},[a("li",[a("span",{staticClass:"light pointer",on:{click:function(a){return t.add_contact_person("update",e.row)}}},[t._v("编辑")])]),a("li",[a("span",{staticClass:"light pointer",on:{click:function(a){return t.del_contact_person("delete_person",e.row)}}},[t._v("删除")])]),a("li",[a("span",{staticClass:"light pointer",on:{click:function(a){return t.add_to_group(e.row)}}},[t._v("添加至报警组")])])])]}}])})],1),a("el-pagination",{staticClass:"pull-right",attrs:{background:!0,"current-page":t.pageInfo.currentPage,"page-size":t.pageInfo.pageSize,"prev-text":"上一页","next-text":"下一页",layout:"prev, pager, next, jumper",total:t.pageInfo.total},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}}),a("add-contact-person",{attrs:{param:t.addParams},on:{personSubmitFn:t.FnGetPersonList,close:function(e){t.addParams.visible=!1}}}),a("el-dialog",{staticClass:"cds-dialog",attrs:{title:t.add_to_group_dialog_title,visible:t.add_to_group_visible},on:{"update:visible":function(e){t.add_to_group_visible=e},close:function(e){return t.addToGroupSubmit(!1)}}},[a("div",{attrs:{"label-width":"120"}},[a("div",{staticClass:"dialog-body"},[t.contact_group_list.length>0?a("div",{staticStyle:{"min-height":"150px",border:"1px solid #dde2ef",padding:"10px"}},[a("el-checkbox-group",{on:{change:t.handleCheckChange},model:{value:t.checkedGroup,callback:function(e){t.checkedGroup=e},expression:"checkedGroup"}},t._l(t.contact_group_list,(function(e,o){return a("el-checkbox",{key:o,staticClass:"pull-left",attrs:{label:e.group_id,disabled:e.disabled}},[e.group_description?a("el-tooltip",{attrs:{content:e.group_description,placement:"bottom",effect:"light"}},[a("span",{domProps:{textContent:t._s(e.group_name)}})]):a("span",{domProps:{textContent:t._s(e.group_name)}})],1)})),1)],1):a("div",[a("p",[t._v("无联系组，点击确定跳转至联系组页面")])])])]),t.contact_group_list.length>0?a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"cds-button",attrs:{type:"primary"},on:{click:function(e){return t.addToGroupSubmit(!0)}}},[t._v("确定")]),a("el-button",{staticClass:"cds-button",on:{click:function(e){return t.addToGroupSubmit(!1)}}},[t._v("取消")])],1):a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("router-link",{staticClass:"el-button el-button--primary cds-button",attrs:{to:{name:"报警联系组"}}},[t._v("确定")]),a("el-button",{staticClass:"cds-button",on:{click:function(e){return t.addToGroupSubmit(!1)}}},[t._v("取消")])],1)]),a("msg-dialog",{attrs:{param:t.msgParam,data:t.operateData},on:{dialogFn:t.onDialog,close:function(e){t.msgParam.visible=!1}}})],1)])},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"navbar-header pull-left flex"},[a("span",{staticClass:"page-title"},[t._v("报警联系人")])])}],s=(a("4160"),a("a9e3"),a("159b"),a("96cf"),a("89ba")),c=(a("0fb7"),a("450d"),a("f529")),r=a.n(c),i=a("58b0"),l=a("498c"),u=a("e0f8"),d=a("4f23"),p={name:"alarm_contact_person",components:{addContactPerson:l["a"],ElDialog:i["a"],msgDialog:d["a"]},data:function(){return{pageInfo:{currentPage:1,pageSize:20,total:0},condition:"contact_name",condition_list:[{label:"姓名",value:"contact_name"},{label:"邮箱",value:"contact_email"}],placeholder_text:"请输入联系人的姓名",search_value:"",contact_person_list:[],add_to_group_dialog_title:"",add_to_group_visible:!1,checkedGroup:[],add_to_group_person_id:"",currentAddToGroup:"",currentGroupPersonNum:"",contact_group_list:[],addParams:{title:"",form:{contact_name:"",contact_email:"",code:""},visible:!1,type:"",personList:[]},msgParam:{visible:!1},operateData:null,operateList:{delete_person:{title:"删除联系人",msg:"确定删除选择的联系人！",msg2:"删除后将不能恢复。"}}}},watch:{condition:{handler:function(t){switch(t){case"":this.placeholder_text="请输入联系人的姓名或邮箱";break;case"contact_name":this.placeholder_text="请输入联系人的姓名";break;case"contact_email":this.placeholder_text="请输入联系人的邮箱";break}}},checkedGroup:{handler:function(t,e){t!==e&&this.get_group_list(t,e)}}},methods:{handleSizeChange:function(t){this.pageInfo.pageSize=t,this.pageInfo.currentPage=1,this.get_contact_person_list()},handleCurrentChange:function(t){this.pageInfo.currentPage=t,this.get_contact_person_list()},resetForm:function(t){var e=this;this.$nextTick((function(){e.$refs[t].resetFields()}))},FnGetPersonList:function(){this.get_contact_person_list()},get_contact_person_list:function(t){var e=this,a={page_number:this.pageInfo.currentPage,page_size:this.pageInfo.pageSize};t&&(a.page_number=Number(t)),"contact_name"==this.condition&&(a.contact_name=this.search_value),"contact_email"==this.condition&&(a.contact_email=this.search_value),u["a"].get_contact_person_list(a).then((function(t){var a=t.data;a&&"Success"==t.code?(e.contact_person_list=a,e.pageInfo.total=t.total_count):r()({message:t.msg,type:"error"})})).catch((function(t){console.log(t)}))},add_contact_person:function(t,e){this.addParams.visible=!0,this.addParams.type=t,"add"==t?(this.addParams.form={contact_name:"",contact_email:"",code:""},this.addParams.title="新建联系人",this.addParams.personList=this.contact_person_list):(this.addParams.form={contact_name:"",contact_email:"",code:""},this.addParams.title="编辑联系人",this.addParams.form=Object.assign({},e))},del_contact_person:function(t,e){this.operateData=this.operateList[t],this.operateData.type=t,this.operateData.contact_ids=e.contact_id,this.msgParam.visible=!0},onDialog:function(){this.get_contact_person_list()},get_contact_group_list:function(){var t=this,e={page_number:1,page_size:1e4};u["a"].get_contact_group_list(e).then((function(e){var a=e.data;a&&"Success"==e.code?(t.contact_group_list=a,t.contact_group_list.forEach((function(e){t.$set(e,"disabled",!1),t.currentAddToGroup.contact_group.forEach((function(a){a==e.group_name&&t.$set(e,"disabled",!0)}))}))):r()({message:e.msg,type:"error"})})).catch((function(t){console.log(t)}))},add_to_group:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.get_contact_group_list(),this.add_to_group_dialog_title="添加至联系组",this.add_to_group_visible=!0,this.add_to_group_person_id=e.contact_id,this.currentAddToGroup=e;case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),handleCheckChange:function(t){console.log(".........",this.checkedGroup)},addToGroupSubmit:function(t){var e=this;if(1==t)if(this.checkedGroup.length>0){var a={group_ids:this.checkedGroup,contact_id:this.add_to_group_person_id};u["a"].add_to_group(a).then((function(t){var a=t.data;e.add_to_group_visible=!1,e.checkedGroup=[],e.currentAddToGroup="",a&&"Success"==t.code?(r()({message:t.msg,type:"success"}),e.get_contact_person_list()):r()({message:t.msg,type:"error"})})).catch((function(t){console.log(t)}))}else r()({message:"请选择联系组",type:"error"});else this.add_to_group_visible=!1,this.checkedGroup=[],this.currentAddToGroup=""},get_group_list:function(t,e){var a=this,o={};this.currentGroupPersonNum="",u["a"].get_contact_group_info_list(o).then((function(o){var n=o.data;n&&"Success"==o.code?(n.forEach((function(e){e.group_id==t[t.length-1]&&(a.currentGroupPersonNum=e.group_contact.length)})),a.currentGroupPersonNum>=10&&(a.checkedGroup=e,r()({message:"一个联系组最多可添加10个联系人",type:"error"}))):r()({message:o.msg,type:"error"})})).catch((function(t){console.log(t)}))}},mounted:function(){this.get_contact_person_list()}},_=p,g=a("2877"),h=Object(g["a"])(_,o,n,!1,null,"635152c2",null);e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-2d208611.3c759353.js.map